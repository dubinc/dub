enum EventType {
  click
  lead
  sale
}

enum RewardStructure {
  percentage
  flat
}

model Reward {
  id                 String          @id @default(cuid())
  programId          String
  description        String?
  event              EventType
  type               RewardStructure @default(percentage)
  amountInCents      Int?
  amountInPercentage Decimal?        @db.Decimal(5, 2)
  maxDuration        Int? // in months (0 -> not recurring, null -> infinite)
  modifiers          Json?           @db.Json
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt

  program           Program             @relation(fields: [programId], references: [id])
  clickEnrollments  ProgramEnrollment[] @relation("ClickRewardEnrollments")
  leadEnrollments   ProgramEnrollment[] @relation("LeadRewardEnrollments")
  saleEnrollments   ProgramEnrollment[] @relation("SaleRewardEnrollments")
  clickPartnerGroup PartnerGroup?       @relation("ClickReward")
  leadPartnerGroup  PartnerGroup?       @relation("LeadReward")
  salePartnerGroup  PartnerGroup?       @relation("SaleReward")
  commissions       Commission[]

  @@index([programId, event])
  @@index(event) // used in aggregate-clicks cron job
}
